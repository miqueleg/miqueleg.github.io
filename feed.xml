<?xml version="1.0" encoding="utf-8"?><feed xmlns="http://www.w3.org/2005/Atom" xml:lang="en"><generator uri="https://jekyllrb.com/" version="4.4.1">Jekyll</generator><link href="https://miqueleg.github.io/feed.xml" rel="self" type="application/atom+xml"/><link href="https://miqueleg.github.io/" rel="alternate" type="text/html" hreflang="en"/><updated>2025-05-22T16:23:25+00:00</updated><id>https://miqueleg.github.io/feed.xml</id><title type="html">Dr. Miquel EstÃ©vez-Gay - Protein Engineering</title><subtitle>Postdoctoral researcher in Computational Protein Engineeering and Molecular Dynamics. Based on [*folio](https://github.com/bogoli/-folio) design. </subtitle><entry><title type="html">Protonation Optimizer</title><link href="https://miqueleg.github.io/blog/2025/Protonation-Optimizer/" rel="alternate" type="text/html" title="Protonation Optimizer"/><published>2025-03-26T18:00:00+00:00</published><updated>2025-03-26T18:00:00+00:00</updated><id>https://miqueleg.github.io/blog/2025/Protonation-Optimizer</id><content type="html" xml:base="https://miqueleg.github.io/blog/2025/Protonation-Optimizer/"><![CDATA[<p>Iâ€™m excited to share my latest computational tool for the molecular modeling community: Protonation Optimizer - a (SemiEmpirical) quantum mechanics-based solution for determining optimal amino acid protonation states in protein structures!</p> <p>ðŸ”¬ Why it matters: Accurate protonation states are critical for reliable molecular dynamics (MD) simulations, yet theyâ€™re often overlooked. Incorrect assignments can lead to artifacts or misleading results, particularly with histidine residues that can exist in multiple tautomeric forms for the same pH conditions.</p> <h4 id="-key-features">âš¡ Key features:</h4> <p>Integrates PropKa3 for pKa predictions and initial state assignments. Employs xTB semi-empirical quantum chemistry calculations to determine energetically favorable protonation states. Handles both HID (Î´-protonated) and HIE (Îµ-protonated) histidine tautomers with QM accuracy. Provides detailed energy reports and automatically generates optimized PDB files.</p> <h3 id="-check-it-out-protonation-optimizer">ðŸ”— Check it out: <a href="https://github.com/miqueleg/protonation-optimizer/tree/main" title="Protonation State Optimizer">Protonation-Optimizer</a></h3> <p>Feel free to use it and let me know how it went!</p> <h1 id="protonation-state-optimizer">Protonation State Optimizer</h1> <p>A quantum mechanics-based tool for determining optimal aminoacidic protonation states (focusing on Histidines) in protein structures for molecular dynamics simulations.</p> <h2 id="description">Description</h2> <p>This tool analyzes protein structures and determines the energetically favorable protonation state for each histidine residue using the xTB semi-empirical quantum chemistry method (HID/HIE). It accurately handles the two neutral tautomeric forms of histidine by:</p> <ol> <li>Checks pKa using the PropKa3 tool. It determines HIP protonation based on pKa</li> <li>Extracting the local environment around each histidine residue</li> <li>Generating both HID (delta-protonated) and HIE (epsilon-protonated) tautomers</li> <li>Special handling of charged residues (ASP, GLU, LYS, ARG) with proper proton positioning</li> <li>Running quantum mechanical energy calculations on each tautomer</li> <li>Comparing energies to determine the optimal protonation state</li> </ol> <p>This tool is particularly useful for preparing protein structures for molecular dynamics simulations where histidine protonation can significantly impact results.</p> <h2 id="dependencies">Dependencies</h2> <h3 id="python-packages">Python Packages</h3> <ul> <li>NumPy</li> <li>Pandas</li> <li>MDTraj</li> <li>BioPython (Bio.PDB)</li> <li>Tabulate</li> </ul> <h3 id="external-software">External Software</h3> <ul> <li>Open Babel (for hydrogen placement)</li> <li>xTB (for quantum mechanical calculations)</li> <li>PropKa3</li> </ul> <h2 id="installation">Installation</h2> <ol> <li> <p>Install the required Python packages:</p> </li> <li> <p>Install Open Babel:</p> </li> <li> <p>Install xTB:</p> </li> <li> <p>Install PropKa3</p> </li> <li> <p>Clone the repository:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>git clone https://github.com/miqueleg/protonation-optimizer
</code></pre></div> </div> </li> </ol> <h2 id="usage">Usage</h2> <p>Basic usage:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>python protonation_optimizer.py input.pdb output.pdb
</code></pre></div></div> <p>With custom environment cutoff (default is 5.0 Ã…):</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>python protonation_optimizer.py input.pdb output.pdb --cutoff 6.0
</code></pre></div></div> <p>Changing Optimization level and Solvent (default loose and ether) :</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>python protonation_optimizer.py input.pdb output.pdb --xtbopt crude --solvent water
</code></pre></div></div> <p>Using Single Point calculations instead of Optimization [Faster but less precise] (default opt) :</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>python protonation_optimizer.py input.pdb output.pdb --mode SP
</code></pre></div></div> <p>This will:</p> <ol> <li>Run PropKa3 and determine initial protonations</li> <li>Find all histidine residues in <code class="language-plaintext highlighter-rouge">protein.pdb</code></li> <li>For each histidine, extract a 5.0 Ã… environment</li> <li>Create both HID and HIE tautomers with proper hydrogen placement</li> <li>Run xTB optimization or single point calculations on each tautomer</li> <li>Determine the optimal protonation state based on energy</li> <li>Generate a detailed report table of the analysis</li> </ol> <h2 id="output-files">Output Files</h2> <p>The tool generates several outputs:</p> <ul> <li>An optimized PDB file with the computed protonation states of the AminoAcids in your protein</li> <li>A CSV file with energy results for each histidine</li> <li>A detailed text report of the analysis</li> <li>xTB log files for each calculation in an <code class="language-plaintext highlighter-rouge">xtb_logs</code> directory</li> </ul> <h2 id="special-features">Special Features</h2> <ul> <li><strong>Charged Residue Handling</strong>: It handles ASP, GLU, LYS, and ARG by pKa/pH comparison using PropKa3</li> <li><strong>Constraint-based Optimization</strong>: Allows hydrogen atoms to relax during energy calculations while keeping heavy atoms fixed</li> </ul> <h2 id="limitations">Limitations</h2> <ul> <li>Only handles the two neutral tautomers via QM (HID and HIE), not the protonated form (HIP). The latest is only determined via pKa calculation</li> <li>Processes each histidine independently; for histidines in close proximity, results may not capture cooperative effects (yet)</li> </ul> <h2 id="citing-this-software">Citing This Software</h2> <p>If you use this tool in your research, please cite it as:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>EstÃ©vez-Gay, M. (2025). Protonation State Optimizer.
GitHub repository: https://github.com/miqueleg/protonation-optimizer
</code></pre></div></div>]]></content><author><name></name></author><category term="script"/><category term="python"/><category term="protonation"/><summary type="html"><![CDATA[Announcement of 200~Protonation Optimizer]]></summary></entry></feed>